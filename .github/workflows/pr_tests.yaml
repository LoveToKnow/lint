name: Lint & Tests

on: [pull_request]

jobs:
  lint_and_test:
    name: Unit Tests
    runs-on: ubuntu-latest
    steps:
      - name: Checkout ğŸ›
        uses: actions/checkout@v2
      - name: Setup Node 14 ğŸ’»
        uses: actions/setup-node@v1
        with:
          node-version: '14.x'
          registry-url: 'https://registry.npmjs.org'

      - name: Add CI PAT to npmrc file âœğŸ½
        # secrets.GITHUB_TOKEN doesn't has access to other (private) repos.
        # so for `npm install`ing, we need a PAT
        run: echo "//npm.pkg.github.com/:_authToken=${{ secrets.PRIVATE_REPO_PAT }}" >> .npmrc

      - name: Install dependencies ğŸ“¦
        run: npm install && npx lerna bootstrap

      - name: Lint ğŸ§¹
        run: npm run lint

      - name: Test ğŸ”¬
        run: npm run test
